---
title: "资源共享"
date: 2022-02-09T19:17:14+08:00
weight: 50
description: >
    介绍资源的共享原则
---

平台中的资源根据资源的归属可以分为域资源和项目资源。

- 域资源：资源归属于域，域下所有项目的用户都可以使用域资源。列表中存在所属域的字段，表示该资源为域资源，包括宿主机、物理机、块存储、云账号、代理、VPC、NAT网关、弹性网卡、二层网络等。
- 项目资源：资源归属于项目，仅项目中的用户可以使用项目资源。列表中存在项目字段（由域、项目组成），表示该资源为项目资源，包括虚拟机、系统镜像、主机镜像、安全组、IP子网、负载均衡实例、访问控制、证书、存储桶、RDS实例、Redis实例等。

### 域资源共享原则

当{{<oem_name>}}开启三级权限后，以下域资源支持共享。当{{<oem_name>}}关闭三级权限后，域资源不支持共享。

- 宿主机、物理机、块存储、云账号、代理、二层网络、VPC、NAT网关、DNS解析等。

#### 共享原则

1. 如果域资源是通过云账号同步下来的，则域资源的共享与云账号有关。
    - 当云账号不共享时，通过云账号同步下来的资源也不能共享。
    - 当云账号启用共享时，通过云账号同步下来的资源也将随着云账号启用共享。
    - 当云账号启用共享时，通过云账号同步下来的资源可以更改共享范围，请确保共享范围在云账号的共享范围内。
    - 当云账号修改共享范围时，通过云账号同步下来的资源的共享范围要始终保持在云账号的共享范围内。如云账号共享A、B、C、D域，域资源共享A、C域，云账号修改共享范围为A、B域，则域资源只能共享到A域。
    - 云账号共享云订阅时，通过云账号同步下来的域资源不能共享。
2. 本地存储的共享范围要始终要与宿主机的共享范围保持一致。

#### 设置共享

以宿主机为例，介绍如何设置宿主机的共享范围。

域资源的共享范围有三种：

- 不共享（私有）：即域资源只能本域的用户可以使用。
- 域共享-部分（多域共享）：即域资源可以共享到指定域（一个或多个），只有域资源所在域和共享域下的用户可以使用域资源。
- 域共享-全部（全局共享）：即域资源可以共享给全部域使用，即系统中所有用户都可以使用域资源。

{{% alert title="说明" %}}
设置共享的条件：需同时满足

- 当前用户在管理后台。
- 在{{<oem_name>}}已开启三级权限。
{{% /alert %}}

**单个宿主机设置共享**

1. 在左侧导航栏，选择 **_"主机/基础资源/宿主机"_** 菜单项，进入宿主机页面。
2. 单击宿主机右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"设置共享"_** 菜单项，弹出设置共享对话框。
3. 配置以下参数：
   - 当共享范围选择为“不共享”时，即域资源的共享范围为私有，仅本域的用户可以使用。
   - 当共享范围选择为“域共享”时，需要选择共享的域。
       - 当域选择其中的一个或多个域时，即域资源的共享范围为域共享-部分，只有域资源所在域和共享域下的用户可以使用域资源。
       - 当域选择全部时，即域资源的共享范围为域共享-全部，系统中的所有用户都可以使用域资源。
4. 单击 **_"确定"_** 按钮，完成操作。

**批量设置共享**

1. 在左侧导航栏，选择 **_"主机/基础资源/宿主机"_** 菜单项，进入宿主机页面。
2. 在宿主机列表中选择一个或多个宿主机，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"设置共享"_** 菜单项，弹出设置共享对话框。
3. 配置以下参数：
   - 当共享范围选择为“不共享”时，即域资源的共享范围为私有，仅本域的用户可以使用。
   - 当共享范围选择为“域共享”时，需要选择共享的域。
       - 当域选择其中的一个或多个域时，即域资源的共享范围为域共享-部分，只有域资源所在域和共享域下的用户可以使用域资源。
       - 当域选择全部时，即域资源的共享范围为域共享-全部，系统中的所有用户都可以使用域资源。
4. 单击 **_"确定"_** 按钮，完成操作。

### 项目资源共享原则

当{{<oem_name>}}开启三级权限后，以下项目资源不仅支持项目共享还支持域共享。当{{<oem_name>}}关闭三级权限后，以下资源仅支持项目共享。

- 系统镜像、主机镜像、安全组、IP子网、访问控制、证书、存储桶。

#### 共享原则

- 一些安全组虽然是通过云账号同步的资源，但是安全组的共享范围与云账号无关。
- 通过云账号同步的IP子网和存储桶的共享范围与云账号共享范围有关。
    - 当云账号不共享时，通过云账号同步下来的项目资源仅可以在域内共享。
    - 当云账号启用共享时，通过云账号同步下来的资源可以更改共享范围，请确保共享范围在云账号的共享范围内。
    - 当云账号修改共享范围时，通过云账号同步下来的资源的共享范围要始终保持在云账号的共享范围内。如云账号共享到A、B、C、D域，项目资源共享A、C域，云账号修改共享范围为A、B域，则项目资源只能共享到A域。
    - 云账号共享云订阅时，通过云账号同步下来的项目资源仅可以在云订阅所属域内共享。

#### 设置共享

以IP子网为例，介绍如何设置IP子网的共享状态。

项目资源的共享范围有五种：

- 不共享（私有）：即项目资源只能本项目的用户可以使用。
- 项目共享-部分（本域内多项目共享）：即项目资源可以共享到同域下的指定项目（一个或多个），只有本项目和被共享项目下的用户可以使用项目资源。
- 项目共享-全部（本域共享）：即项目资源可以共享给域下所有项目，即项目所在域的用户都可以使用项目资源。
- 域共享-部分（多域共享）：即项目资源可以共享到指定域（一个或多个），只有项目资源所在域和共享域下的用户可以使用项目资源。
- 域共享-全部（全局共享）：即项目资源可以共享给全部域使用，即系统中所有用户都可以使用项目资源。

{{% alert title="说明" %}}
设置域共享的条件：

- 在{{<oem_name>}}平台已开启三级权限。
- 用户处于管理后台。

设置项目共享的条件：

- 用户处于管理后台或域管理后台。

{{% /alert %}}

{{% alert title="注意" color="warning" %}}
- 物理机、PXE、IPMI类型的IP子网建议不要设置为共享状态。
- 本地IDC的IP子网共享范围任意。
- 私有云和公有云的IP子网的共享范围与云账号的共享范围有关。
    - 当云账号不共享时，通过云账号同步下来的项目资源仅可以在域内共享。
    - 当云账号启用共享时，通过云账号同步下来的资源可以更改共享范围，请确保共享范围在云账号的共享范围内。
    - 当云账号修改共享范围时，通过云账号同步下来的资源的共享范围要始终保持在云账号的共享范围内。如云账号共享到A、B、C、D域，项目资源共享A、C域，云账号修改共享范围为A、B域，则项目资源只能共享到A域。
    - 云账号共享云订阅时，通过云账号同步下来的项目资源仅可以在云订阅所属域内共享。
{{% /alert %}}


**单个IP子网设置共享**

1. 在IP子网页面，单击IP子网右侧操作列 **_"更多"_** 按钮，选择下拉菜单 **_"设置共享"_** 菜单项，弹出设置共享对话框。
2. 配置以下参数。
   - 当共享范围选择为“不共享”时，即项目资源的共享范围为私有，仅本项目的用户可以使用。
   - 当共享范围选择为“项目共享”时，需要选择本域下可共享的项目。
       - 当项目选择同域下的一个或多个项目时，即项目资源的共享范围为项目共享-部分，只有项目资源所在项目和共享项目下的用户可以使用项目资源。
       - 当项目选择全部时，即项目资源的共享范围为项目共享-全部，项目所在域下的用户都可以使用项目资源。
   - 当共享范围选择为“域共享”时，需要选择共享的域。
       - 当域选择其中的一个或多个域时，即项目资源的共享范围为域共享-部分，只有项目资源所在域和共享域下的用户可以使用域资源。
       - 当域选择全部时，即项目资源的共享范围为域共享-全部，系统中的所有用户都可以使用项目资源。
3. 单击 **_"确定"_** 按钮，完成操作。

**批量设置共享**

多个IP子网批量设置的共享范围必须相同。否则请单独为IP子网设置共享。

1. 在IP子网列表中选择一个或多个IP子网，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"设置共享"_** 菜单项，弹出设置共享对话框。
2. 配置以下参数。
   - 当共享范围选择为“不共享”时，即项目资源的共享范围为私有，仅本项目的用户可以使用。
   - 当共享范围选择为“项目共享”时，需要选择本域下可共享的项目。
       - 当项目选择同域下的一个或多个项目时，即项目资源的共享范围为项目共享-部分，只有项目资源所在项目和共享项目下的用户可以使用项目资源。
       - 当项目选择全部时，即项目资源的共享范围为项目共享-全部，项目所在域下的用户都可以使用项目资源。
   - 当共享范围选择为“域共享”时，需要选择共享的域。
       - 当域选择其中的一个或多个域时，即项目资源的共享范围为域共享-部分，只有项目资源所在域和共享域下的用户可以使用域资源。
       - 当域选择全部时，即项目资源的共享范围为域共享-全部，系统中的所有用户都可以使用项目资源。
3. 单击 **_"确定"_** 按钮，完成操作。

