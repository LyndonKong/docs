---
title: "设置免密登录"
date: 2022-01-06T16:38:23+08:00
weight: 40
description: >
    将虚拟机设置为能被 var_oem_name 平台免密登录
---

该功能用于将虚拟机设置为能被平台免密登录。

虚拟机能被平台免密登录需要满足以下条件：

- 虚拟机与平台网络通（即通过EIP、NAT网关或SSH代理等方式使虚拟机与平台网络通）以及
- 虚拟机中存在平台的公钥文件；

设置免密登录功能仅用于将平台的公钥拷贝到虚拟机中，请先确保虚拟机与平台网络通。

**设置免密登录**

1. 在左侧导航栏，选择 **_"主机/主机/虚拟机"_** 菜单项，进入虚拟机页面。
2. 单击虚拟机右侧操作列 **_"更多"_** 按钮，选择 **_"密码密钥-设置免密登录"_** 菜单项，弹出设置免密登录对话框。
2. 配置以下参数：
    - SSH端口：修改虚拟机的SSH端口，将通过该端口免密登录到虚拟机。
    - 设置方式：支持密钥、密码、脚本等方式将平台的公钥上传到虚拟机上。
    - 当设置方式为“密钥”时，请使用root用户或具有使用sudo免密权限的用户以其私钥，请确保可以通过用户名和私钥通过ssh连接到对应虚拟机，单击 **_"确定"_** 按钮，进入等待执行结果页面，开始设置并探测虚拟机的免密登录状态是否变为免密登录。
    - 当设置方式为“密码”时，请使用root用户或具有使用sudo免密权限的用户以其密码，请确保可以通过用户名和密码通过ssh连接到对应虚拟机。单击 **_"确定"_** 按钮，进入等待执行结果页面，开始设置并探测虚拟机的免密登录状态是否变为免密登录。
    - 当设置方式为“脚本”时，请请使用root或具有sudo权限的用户在虚拟机中执行以下脚本，执行完成后，单击 **_"确定"_** 按钮，进入等待执行结果页面，开始设置并探测虚拟机的免密登录状态是否变为免密登录。
3. 若虚拟机可以免密登录，直接单击 **_"关闭"_** 按钮。
4. 若虚拟机仍不可免密登录，请在操作列表查看不可免密登录的原因。
    - 如报错原因中提示“Failed to connect to the host via ssh”，则需要先将该虚拟机通过绑定EIP或NAT网关以及SSH代理等方式，使其与平台网络可通。
    - 如报错原因中提示“Permission denied”，则表示输入的信息错误，可单击 **_"上一步"_** 按钮，修改配置，继续设置并探测。


**批量设置免密登录**

只支持批量为同一项目下的虚拟机设置免密登录。

1. 在虚拟机列表中选择一个或多个虚拟机，单击列表上方 **_"批量操作"_** 按钮，选择下拉菜单 **_"密码密钥-设置免密登录"_** 菜单项，弹出设置免密登录对话框。
2. 配置以下参数：
    - SSH端口：修改虚拟机的SSH端口，将通过该端口免密登录到虚拟机。
    - 设置方式：支持密钥、密码、脚本等方式将平台的公钥上传到虚拟机上。
    - 当设置方式为“密钥”时，请使用root用户或具有使用sudo免密权限的用户以其私钥，请确保可以通过用户名和私钥通过ssh连接到对应虚拟机，单击 **_"确定"_** 按钮，进入等待执行结果页面，开始设置并探测虚拟机的免密登录状态是否变为免密登录。
    - 当设置方式为“密码”时，请使用root用户或具有使用sudo免密权限的用户以其密码，请确保可以通过用户名和密码通过ssh连接到对应虚拟机。单击 **_"确定"_** 按钮，进入等待执行结果页面，开始设置并探测虚拟机的免密登录状态是否变为免密登录。
    - 当设置方式为“脚本”时，请请使用root或具有sudo权限的用户在虚拟机中执行以下脚本，执行完成后，单击 **_"确定"_** 按钮，进入等待执行结果页面，开始设置并探测虚拟机的免密登录状态是否变为免密登录。
4. 若虚拟机可以免密登录，直接单击 **_"关闭"_** 按钮。
5. 若虚拟机仍不可免密登录，请在操作列表查看不可免密登录的原因。
    - 如报错原因中提示“Failed to connect to the host via ssh”，则需要先将该虚拟机通过绑定EIP、NAT网关以或SSH代理等方式，使其与平台网络可通。
    - 如报错原因中提示“Permission denied”，则表示输入的信息错误，可单击 **_"上一步"_** 按钮，修改配置，继续设置并探测。
